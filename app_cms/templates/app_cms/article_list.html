{% extends "base.html" %}
{% load static %}
{% block title %} CMS | Article list {% endblock %}

{% block content %}
    <div class="flex flex-col w-full">
        <div class="container mx-auto px-4 sm:px-6 py-8">
            {% for article in articles %}
                <a href="{% url 'article_detail' article.id %}">
                    <div class="flex flex-col sm:flex-row gap-4 sm:gap-10 items-center bg-white text-black shadow-lg rounded-lg p-4 sm:py-2 mb-6">
                        <span class="text-xl sm:text-2xl mb-2 sm:mb-0">{{ forloop.counter }}</span>
                        <img src="{{ article.imageURL }}" alt="{{ article.title }}" class="w-24 h-24 sm:w-10 sm:h-10 object-cover object-center rounded-lg mb-2 sm:mb-0">
                        <h2 class="text-lg sm:text-md w-full sm:w-auto">{{ article.title }}</h2>
                        <p class="text-sm sm:text-md mb-2 sm:mb-0">Author: {{ article.author }}</p>
                        <p class="text-sm sm:text-md">Published date: {{ article.published_date }}</p>
                        <!-- Edit and Delete buttons (only visible if the user is authenticated) -->
                        {% if is_authenticated %}
                        <a href="{% url 'edit_article' article.id %}" class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600">Edit</a>
                        <a href="{% url 'delete_article' article.id %}" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600" onclick="return confirm('Are you sure you want to delete this article?')">Delete</a>
                        {% endif %}
                    </div>
                </a>
            {% endfor %}
        </div>
        <a href="{% url 'new_article' %}" id='new_article' class="fixed bottom-6 sm:bottom-[6%] lg:left-[90%] sm:left-[42%] justify-center items-center w-16 h-16 sm:w-20 sm:h-20 rounded">
            <img class="w-15 h-15" src="{% static 'images/create-new.png' %}" title="Create new article!">
        </a>
    </div>

    <script>
        let isAuthenticated = {{ is_authenticated|lower }};
        const newArticle = document.getElementById('new_article');
    
        if (isAuthenticated) {
            newArticle.style.display = "flex";
        } else {
            newArticle.style.display = "none";
        }
    </script>
{% endblock %}
